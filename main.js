/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => TodoistIndicatorPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  todoistProperty: "todoist",
  projectsFolderPrefix: "1.Projects/",
  projectTag: "#project",
  RequireProjectTag: true,
  tdiSetting: "default",
  projectFileCache: {}
};
function getFrontMatter(markdownString) {
  const frontMatterMatch = markdownString.match(/^---\n([\s\S]*?)\n---/);
  if (frontMatterMatch) {
    const yamlContent = frontMatterMatch[1];
    return parseYaml(yamlContent);
  }
  return null;
}
function parseYaml(yamlContent) {
  const lines = yamlContent.split("\n");
  const result = {};
  let currentKey = null;
  lines.forEach((line) => {
    if (line.trim() === "")
      return;
    const keyValueMatch = line.match(/^(\s*)([^:]+):\s*(.*)$/);
    if (keyValueMatch) {
      const indent = keyValueMatch[1].length;
      const key = keyValueMatch[2].trim();
      const value = keyValueMatch[3].trim();
      if (indent === 0) {
        result[key] = parseYamlValue(value);
        currentKey = key;
      } else if (indent > 0 && Array.isArray(result[currentKey])) {
        result[currentKey].push(parseYamlValue(value));
      }
    } else if (currentKey && Array.isArray(result[currentKey])) {
      result[currentKey].push(parseYamlValue(line.trim()));
    }
  });
  return result;
}
function parseYamlValue(value) {
  if (value === "true")
    return true;
  if (value === "false")
    return false;
  if (!isNaN(value))
    return parseFloat(value);
  return value;
}
var findTodoistProperty = (string, todoistProperty) => {
  const frontMatter = getFrontMatter(string);
  return checkTodoistPropertyHasValue(frontMatter, todoistProperty);
};
function checkTodoistPropertyHasValue(frontMatter, todoistPropertyName) {
  if (frontMatter && frontMatter.hasOwnProperty(todoistPropertyName)) {
    const value = frontMatter[todoistPropertyName];
    if (typeof value === "string" && value.trim() !== "") {
      return true;
    }
  }
  return false;
}
var clearAllBadges = (fileItem) => {
  fileItem.coverEl.removeClass("todoist-indicator");
};
var paintFileBadge = function(opts, fileItem) {
  const slashes = fileItem.file.path.match(/\//g);
  const fileInFolder = slashes ? slashes.length >= 1 : 0;
  const folderItem = this.app.workspace.getLeavesOfType("file-explorer")[0].view.fileItems[fileItem.file.parent.path];
  const { TodoistLink } = opts || {};
  if (!TodoistLink) {
    fileItem.coverEl.addClass("todoist-indicator");
    if (fileInFolder) {
      folderItem.coverEl.addClass("todoist-indicator");
    }
  } else {
    clearAllBadges(fileItem);
    if (fileInFolder) {
      clearAllBadges(folderItem);
    }
  }
};
function getFileByPath(filepath) {
  const files = this.app.vault.getFiles();
  const fileFound = files.find((file) => file.path === filepath);
  if (fileFound) {
    return fileFound;
  } else {
    return "Not a file";
  }
}
function containsTag(file, tag) {
  var _a, _b;
  const fileCache = this.app.metadataCache.getFileCache(file);
  if (!fileCache) {
    console.error(`File cache not found for file: ${file.path}`);
    return false;
  }
  const metadata = (_a = fileCache.tags) == null ? void 0 : _a.map((a) => a.tag);
  let containsTagFile = false;
  if (Array.isArray(metadata)) {
    containsTagFile = metadata.filter((tg) => tg.includes(tag)).length > 0;
  }
  const frontMatterTags = (_b = fileCache.frontmatter) == null ? void 0 : _b.tags;
  let containstTagFrontMatter = false;
  const tagWithoutHash = tag.replace("#", "");
  if (Array.isArray(frontMatterTags)) {
    containstTagFrontMatter = frontMatterTags.filter((tg) => tg.includes(tagWithoutHash)).length > 0;
  }
  return containstTagFrontMatter || containsTagFile;
}
var TodoistIndicatorPlugin = class extends import_obsidian.Plugin {
  constructor() {
    super(...arguments);
    this.isProjectFile = (filename) => {
      let hasProjectTag = false;
      const file = getFileByPath.call(this, filename);
      if (file != "Not a file") {
        hasProjectTag = containsTag.call(this, file, this.settings.projectTag);
      }
      if (Boolean(this.settings.RequireProjectTag)) {
        return filename.startsWith(this.settings.projectsFolderPrefix) && filename.endsWith(".md") && !filename.includes("/_") && hasProjectTag;
      } else {
        console.log("no");
        return filename.startsWith(this.settings.projectsFolderPrefix) && filename.endsWith(".md") && !filename.includes("/_");
      }
    };
    this.scheduleRepaintBadge = (path, clearAll) => {
      window.setTimeout(() => {
        var _a, _b, _c;
        const leaves = this.app.workspace.getLeavesOfType("file-explorer");
        if ((_c = (_b = (_a = leaves == null ? void 0 : leaves[0]) == null ? void 0 : _a.view) == null ? void 0 : _b.fileItems) == null ? void 0 : _c[path]) {
          if (clearAll)
            clearAllBadges(leaves[0].view.fileItems[path]);
          else
            paintFileBadge.call(this, this.settings.projectFileCache[path], leaves[0].view.fileItems[path]);
        }
      });
    };
    this.updateFileCacheAndMaybeRepaintBadge = async ({ path, stat, deleted }, originalFilename) => {
      if (deleted || !this.isProjectFile(path)) {
        delete this.settings.projectFileCache[path];
        delete this.settings.projectFileCache[originalFilename];
        await this.saveSettings();
        return this.scheduleRepaintBadge(path, true);
      }
      if (!deleted) {
        const string = await this.app.vault.cachedRead(this.app.vault.getAbstractFileByPath(path));
        const { TodoistLink } = this.settings.projectFileCache[path] || {};
        this.settings.projectFileCache[path] = this.settings.projectFileCache[path] || {};
        this.settings.projectFileCache[path].mtime = stat.mtime;
        this.settings.projectFileCache[path].TodoistLink = findTodoistProperty(string, this.todoistProperty);
        await this.saveSettings();
        if (this.settings.projectFileCache[path].TodoistLink !== TodoistLink) {
          this.scheduleRepaintBadge(path);
        }
      }
    };
    this.refreshAllFileBadges = async () => {
      var _a;
      const projectFilesList = this.app.vault.getMarkdownFiles().filter((f) => this.isProjectFile(f.path));
      const filesMap = {};
      let needToSave = false;
      for (const tFile of projectFilesList) {
        filesMap[tFile.path] = this.settings.projectFileCache[tFile.path] || {
          mtime: tFile.stat.mtime
        };
        const lastCache = this.settings.projectFileCache[tFile.path];
        if (tFile.stat.mtime > (lastCache ? lastCache.mtime : 0)) {
          needToSave = true;
          const string = await this.app.vault.cachedRead(tFile);
          filesMap[tFile.path].TodoistLink = findTodoistProperty(string, this.todoistProperty);
        }
      }
      for (const path in this.settings.projectFileCache)
        if (!filesMap[path])
          needToSave = true;
      if (needToSave) {
        this.settings.projectFileCache = filesMap;
        await this.saveSettings();
      }
      const leaves = this.app.workspace.getLeavesOfType("file-explorer");
      if (leaves == null ? void 0 : leaves.length) {
        const fileItems = ((_a = leaves[0].view) == null ? void 0 : _a.fileItems) || {};
        for (const f in fileItems)
          if (this.isProjectFile(f)) {
            try {
              paintFileBadge.call(this, filesMap[f], fileItems[f]);
            } catch (error) {
              console.error(`Error painting badge for file: ${f}`, error);
            }
          }
      }
    };
    this.initialize = () => {
      this.refreshAllFileBadges().catch((error) => {
        console.error('Unexpected error in "todoist-indicator" plugin initialization.', error);
      });
    };
  }
  async onload() {
    await this.loadSettings();
    this.addSettingTab(new SettingTab(this.app, this));
    this.todoistProperty = this.settings.todoistProperty;
    const handleEvent = (event, originalFilename) => {
      if (!this.isProjectFile(event.path) && (!originalFilename || !this.isProjectFile(originalFilename)))
        return;
      this.updateFileCacheAndMaybeRepaintBadge(event, originalFilename).catch((error) => {
        console.error("Error while handling event!", error);
      });
    };
    this.registerEvent(this.app.vault.on("delete", handleEvent));
    this.registerEvent(this.app.vault.on("rename", handleEvent));
    this.registerEvent(this.app.vault.on("modify", handleEvent));
    this.app.workspace.onLayoutReady(this.initialize.bind(this));
    this.addSettingTab(new SettingTab(this.app, this));
  }
  onunload() {
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
var SettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Todoist Indicator plugin Settings" });
    containerEl.createEl("p", { text: "Please reload Obsidian after changing these settings for them to take effect." });
    new import_obsidian.Setting(containerEl).setName("Projects folder").setDesc('The folder where project files live, e.g. "Projects/".').addText(
      (text) => text.setPlaceholder(DEFAULT_SETTINGS.projectsFolderPrefix).setValue(this.plugin.settings.projectsFolderPrefix).onChange(async (value) => {
        this.plugin.settings.projectsFolderPrefix = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Todoist tag").setDesc("The tag that indicates Todoist link.").addText(
      (text) => text.setPlaceholder(DEFAULT_SETTINGS.todoistProperty).setValue(this.plugin.settings.todoistProperty).onChange(async (value) => {
        this.plugin.settings.todoistProperty = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Require Project Tag?").setDesc("With this setting enabled, badges will only appear on files (and their containing folder) with the project tag.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.RequireProjectTag).onChange(async (value) => {
        this.plugin.settings.RequireProjectTag = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Project tag").setDesc("The tag that indicates a file is a project file (handy in case you store project related files in a project folder).").addText(
      (text) => text.setPlaceholder(DEFAULT_SETTINGS.projectTag).setValue(this.plugin.settings.projectTag).onChange(async (value) => {
        this.plugin.settings.projectTag = value;
        await this.plugin.saveSettings();
      })
    );
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBFZGl0b3IsIE1hcmtkb3duVmlldywgTW9kYWwsIE5vdGljZSwgUGx1Z2luLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5pbnRlcmZhY2UgVG9kb2lzdEluZGljYXRvclNldHRpbmdzIHtcblx0dGRpU2V0dGluZzogc3RyaW5nO1xuXHR0b2RvaXN0UHJvcGVydHk6IHN0cmluZztcblx0cHJvamVjdHNGb2xkZXJQcmVmaXg6IHN0cmluZztcblx0cHJvamVjdFRhZzogc3RyaW5nO1xuXHRSZXF1aXJlUHJvamVjdFRhZzogYm9vbGVhbjtcblx0cHJvamVjdEZpbGVDYWNoZTogUmVjb3JkPHN0cmluZywgYW55Pjtcbn1cblxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogUGFydGlhbDxUb2RvaXN0SW5kaWNhdG9yU2V0dGluZ3M+ID0ge1xuXHR0b2RvaXN0UHJvcGVydHk6ICd0b2RvaXN0Jyxcblx0cHJvamVjdHNGb2xkZXJQcmVmaXg6ICcxLlByb2plY3RzLycsXG5cdHByb2plY3RUYWc6ICcjcHJvamVjdCcsXG5cdFJlcXVpcmVQcm9qZWN0VGFnOiB0cnVlLFxuXHR0ZGlTZXR0aW5nOiAnZGVmYXVsdCcsXG5cdHByb2plY3RGaWxlQ2FjaGU6IHt9XG59O1xuXG5mdW5jdGlvbiBnZXRGcm9udE1hdHRlcihtYXJrZG93blN0cmluZzogc3RyaW5nKSB7XG5cdGNvbnN0IGZyb250TWF0dGVyTWF0Y2ggPSBtYXJrZG93blN0cmluZy5tYXRjaCgvXi0tLVxcbihbXFxzXFxTXSo/KVxcbi0tLS8pO1xuXHRpZiAoZnJvbnRNYXR0ZXJNYXRjaCkge1xuXHRcdGNvbnN0IHlhbWxDb250ZW50ID0gZnJvbnRNYXR0ZXJNYXRjaFsxXTtcblx0XHRyZXR1cm4gcGFyc2VZYW1sKHlhbWxDb250ZW50KTtcblx0fVxuXHRyZXR1cm4gbnVsbDtcbn1cblxuZnVuY3Rpb24gcGFyc2VZYW1sKHlhbWxDb250ZW50OiBzdHJpbmcpIHtcblx0Y29uc3QgbGluZXMgPSB5YW1sQ29udGVudC5zcGxpdCgnXFxuJyk7XG5cdGNvbnN0IHJlc3VsdCA9IHt9O1xuXHRsZXQgY3VycmVudEtleSA9IG51bGw7XG5cblx0bGluZXMuZm9yRWFjaChsaW5lID0+IHtcblx0XHRpZiAobGluZS50cmltKCkgPT09ICcnKSByZXR1cm47XG5cblx0XHRjb25zdCBrZXlWYWx1ZU1hdGNoID0gbGluZS5tYXRjaCgvXihcXHMqKShbXjpdKyk6XFxzKiguKikkLyk7XG5cdFx0aWYgKGtleVZhbHVlTWF0Y2gpIHtcblx0XHRcdGNvbnN0IGluZGVudCA9IGtleVZhbHVlTWF0Y2hbMV0ubGVuZ3RoO1xuXHRcdFx0Y29uc3Qga2V5ID0ga2V5VmFsdWVNYXRjaFsyXS50cmltKCk7XG5cdFx0XHRjb25zdCB2YWx1ZSA9IGtleVZhbHVlTWF0Y2hbM10udHJpbSgpO1xuXG5cdFx0XHRpZiAoaW5kZW50ID09PSAwKSB7XG5cdFx0XHRcdHJlc3VsdFtrZXldID0gcGFyc2VZYW1sVmFsdWUodmFsdWUpO1xuXHRcdFx0XHRjdXJyZW50S2V5ID0ga2V5O1xuXHRcdFx0fSBlbHNlIGlmIChpbmRlbnQgPiAwICYmIEFycmF5LmlzQXJyYXkocmVzdWx0W2N1cnJlbnRLZXldKSkge1xuXHRcdFx0XHRyZXN1bHRbY3VycmVudEtleV0ucHVzaChwYXJzZVlhbWxWYWx1ZSh2YWx1ZSkpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSBpZiAoY3VycmVudEtleSAmJiBBcnJheS5pc0FycmF5KHJlc3VsdFtjdXJyZW50S2V5XSkpIHtcblx0XHRcdHJlc3VsdFtjdXJyZW50S2V5XS5wdXNoKHBhcnNlWWFtbFZhbHVlKGxpbmUudHJpbSgpKSk7XG5cdFx0fVxuXHR9KTtcblxuXHRyZXR1cm4gcmVzdWx0O1xufVxuXG5mdW5jdGlvbiBwYXJzZVlhbWxWYWx1ZSh2YWx1ZTogc3RyaW5nKSB7XG5cdGlmICh2YWx1ZSA9PT0gJ3RydWUnKSByZXR1cm4gdHJ1ZTtcblx0aWYgKHZhbHVlID09PSAnZmFsc2UnKSByZXR1cm4gZmFsc2U7XG5cdGlmICghaXNOYU4odmFsdWUpKSByZXR1cm4gcGFyc2VGbG9hdCh2YWx1ZSk7XG5cdHJldHVybiB2YWx1ZTtcbn1cblxuY29uc3QgZmluZFRvZG9pc3RQcm9wZXJ0eSA9IChzdHJpbmc6IHN0cmluZywgdG9kb2lzdFByb3BlcnR5OiBzdHJpbmcpID0+IHtcblx0Y29uc3QgZnJvbnRNYXR0ZXIgPSBnZXRGcm9udE1hdHRlcihzdHJpbmcpO1xuXHRyZXR1cm4gY2hlY2tUb2RvaXN0UHJvcGVydHlIYXNWYWx1ZShmcm9udE1hdHRlciwgdG9kb2lzdFByb3BlcnR5KTtcbn07XG5cbmZ1bmN0aW9uIGNoZWNrVG9kb2lzdFByb3BlcnR5SGFzVmFsdWUoZnJvbnRNYXR0ZXI6IGFueSwgdG9kb2lzdFByb3BlcnR5TmFtZTogc3RyaW5nKSB7XG5cdGlmIChmcm9udE1hdHRlciAmJiBmcm9udE1hdHRlci5oYXNPd25Qcm9wZXJ0eSh0b2RvaXN0UHJvcGVydHlOYW1lKSkge1xuXHRcdGNvbnN0IHZhbHVlID0gZnJvbnRNYXR0ZXJbdG9kb2lzdFByb3BlcnR5TmFtZV07XG5cdFx0aWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgJiYgdmFsdWUudHJpbSgpICE9PSAnJykge1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXHR9XG5cdHJldHVybiBmYWxzZTtcbn1cblxuY29uc3QgY2xlYXJBbGxCYWRnZXMgPSAoZmlsZUl0ZW06IGFueSkgPT4ge1xuXHRmaWxlSXRlbS5jb3ZlckVsLnJlbW92ZUNsYXNzKCd0b2RvaXN0LWluZGljYXRvcicpO1xufTtcblxuY29uc3QgcGFpbnRGaWxlQmFkZ2UgPSBmdW5jdGlvbiAodGhpczogVG9kb2lzdEluZGljYXRvclBsdWdpbiwgb3B0czogYW55LCBmaWxlSXRlbTogYW55KSB7XG5cdFxuXHRcblx0Y29uc3Qgc2xhc2hlcyA9IGZpbGVJdGVtLmZpbGUucGF0aC5tYXRjaCgvXFwvL2cpO1xuXHRjb25zdCBmaWxlSW5Gb2xkZXIgPSBzbGFzaGVzID8gc2xhc2hlcy5sZW5ndGggPj0gMSA6IDA7XG5cdFxuXHRjb25zdCBmb2xkZXJJdGVtID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnZmlsZS1leHBsb3JlcicpWzBdLnZpZXcuZmlsZUl0ZW1zW2ZpbGVJdGVtLmZpbGUucGFyZW50LnBhdGhdO1xuXG5cdGNvbnN0IHsgVG9kb2lzdExpbmsgfSA9IG9wdHMgfHwge307XG5cblx0aWYgKCFUb2RvaXN0TGluaykge1xuXHRcdGZpbGVJdGVtLmNvdmVyRWwuYWRkQ2xhc3MoJ3RvZG9pc3QtaW5kaWNhdG9yJyk7XG5cdFx0aWYgKGZpbGVJbkZvbGRlcikge1xuXHRcdFx0Zm9sZGVySXRlbS5jb3ZlckVsLmFkZENsYXNzKCd0b2RvaXN0LWluZGljYXRvcicpO1xuXHRcdH1cblx0fSBlbHNlIHtcblx0XHRjbGVhckFsbEJhZGdlcyhmaWxlSXRlbSk7XG5cdFx0aWYgKGZpbGVJbkZvbGRlcikge1xuXHRcdFx0Y2xlYXJBbGxCYWRnZXMoZm9sZGVySXRlbSk7XG5cdFx0fVxuXHR9XG59O1xuXG5mdW5jdGlvbiBnZXRGaWxlQnlQYXRoKGZpbGVwYXRoOiBzdHJpbmcpIHtcblx0Y29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRGaWxlcygpO1xuXHRjb25zdCBmaWxlRm91bmQgPSBmaWxlcy5maW5kKGZpbGUgPT4gZmlsZS5wYXRoID09PSBmaWxlcGF0aCk7XG5cdGlmIChmaWxlRm91bmQpIHtcblx0XHRyZXR1cm4gZmlsZUZvdW5kO1xuXHR9IGVsc2Uge1xuXHRcdHJldHVybiBcIk5vdCBhIGZpbGVcIjtcblx0fVxufVxuXG5mdW5jdGlvbiBjb250YWluc1RhZyhmaWxlOiBhbnksIHRhZzogc3RyaW5nKSB7XG5cdGNvbnN0IGZpbGVDYWNoZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xuXHRpZiAoIWZpbGVDYWNoZSkge1xuXHRcdGNvbnNvbGUuZXJyb3IoYEZpbGUgY2FjaGUgbm90IGZvdW5kIGZvciBmaWxlOiAke2ZpbGUucGF0aH1gKTtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblxuXHRjb25zdCBtZXRhZGF0YSA9IGZpbGVDYWNoZS50YWdzPy5tYXAoKGE6IGFueSkgPT4gYS50YWcpO1xuXHRsZXQgY29udGFpbnNUYWdGaWxlID0gZmFsc2U7XG5cdGlmIChBcnJheS5pc0FycmF5KG1ldGFkYXRhKSkge1xuXHRcdGNvbnRhaW5zVGFnRmlsZSA9IG1ldGFkYXRhLmZpbHRlcigodGc6IHN0cmluZykgPT4gdGcuaW5jbHVkZXModGFnKSkubGVuZ3RoID4gMDtcblx0fVxuXG5cdGNvbnN0IGZyb250TWF0dGVyVGFncyA9IGZpbGVDYWNoZS5mcm9udG1hdHRlcj8udGFncztcblx0bGV0IGNvbnRhaW5zdFRhZ0Zyb250TWF0dGVyID0gZmFsc2U7XG5cblx0Y29uc3QgdGFnV2l0aG91dEhhc2ggPSB0YWcucmVwbGFjZSgnIycsICcnKTtcblxuXHRpZiAoQXJyYXkuaXNBcnJheShmcm9udE1hdHRlclRhZ3MpKSB7XG5cdFx0Y29udGFpbnN0VGFnRnJvbnRNYXR0ZXIgPSBmcm9udE1hdHRlclRhZ3MuZmlsdGVyKCh0Zzogc3RyaW5nKSA9PiB0Zy5pbmNsdWRlcyh0YWdXaXRob3V0SGFzaCkpLmxlbmd0aCA+IDA7XG5cdH1cblxuXHRyZXR1cm4gY29udGFpbnN0VGFnRnJvbnRNYXR0ZXIgfHwgY29udGFpbnNUYWdGaWxlO1xufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUb2RvaXN0SW5kaWNhdG9yUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcblx0c2V0dGluZ3M6IFRvZG9pc3RJbmRpY2F0b3JTZXR0aW5ncztcblxuXHRhc3luYyBvbmxvYWQoKSB7XG5cdFx0YXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcblx0XG5cdFx0dGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG5cblx0XHR0aGlzLnRvZG9pc3RQcm9wZXJ0eSA9IHRoaXMuc2V0dGluZ3MudG9kb2lzdFByb3BlcnR5O1xuXG5cdFx0Y29uc3QgaGFuZGxlRXZlbnQgPSAoZXZlbnQ6IGFueSwgb3JpZ2luYWxGaWxlbmFtZTogc3RyaW5nKSA9PiB7XG5cdFx0XG5cdFx0Ly9LcE1hIFRvZG86IGFkZCBoYW5kbGVyIGZvciBmaWxlcyB3aXRob3V0IHRhZ3Ncblx0XHRcdGlmICghdGhpcy5pc1Byb2plY3RGaWxlKGV2ZW50LnBhdGgpICYmICghb3JpZ2luYWxGaWxlbmFtZSB8fCAhdGhpcy5pc1Byb2plY3RGaWxlKG9yaWdpbmFsRmlsZW5hbWUpKSkgcmV0dXJuO1xuXHRcdFx0dGhpcy51cGRhdGVGaWxlQ2FjaGVBbmRNYXliZVJlcGFpbnRCYWRnZShldmVudCwgb3JpZ2luYWxGaWxlbmFtZSkuY2F0Y2goZXJyb3IgPT4ge1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKCdFcnJvciB3aGlsZSBoYW5kbGluZyBldmVudCEnLCBlcnJvcik7XG5cdFx0XHR9KTtcblx0XHR9O1xuXG5cdFx0dGhpcy5yZWdpc3RlckV2ZW50KHRoaXMuYXBwLnZhdWx0Lm9uKCdkZWxldGUnLCBoYW5kbGVFdmVudCkpO1xuXHRcdHRoaXMucmVnaXN0ZXJFdmVudCh0aGlzLmFwcC52YXVsdC5vbigncmVuYW1lJywgaGFuZGxlRXZlbnQpKTtcblx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5hcHAudmF1bHQub24oJ21vZGlmeScsIGhhbmRsZUV2ZW50KSk7XG5cblx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub25MYXlvdXRSZWFkeSh0aGlzLmluaXRpYWxpemUuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG5cdH1cblxuXHRvbnVubG9hZCgpIHtcblx0XHQvLyBBbnkgY2xlYW51cCBjYW4gZ28gaGVyZVxuXHR9XG5cblx0YXN5bmMgbG9hZFNldHRpbmdzKCkge1xuXHRcdHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xuXHR9XG5cblx0YXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuXHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG5cdH1cblxuXHRpc1Byb2plY3RGaWxlID0gKGZpbGVuYW1lOiBzdHJpbmcpID0+IHtcblxuXHRcdGxldCBoYXNQcm9qZWN0VGFnID0gZmFsc2U7XG5cdFx0Y29uc3QgZmlsZSA9IGdldEZpbGVCeVBhdGguY2FsbCh0aGlzLCBmaWxlbmFtZSk7XG5cblx0XHRpZiAoZmlsZSAhPSBcIk5vdCBhIGZpbGVcIikge1xuXHRcdFx0aGFzUHJvamVjdFRhZyA9IGNvbnRhaW5zVGFnLmNhbGwodGhpcywgZmlsZSwgdGhpcy5zZXR0aW5ncy5wcm9qZWN0VGFnKTtcblx0XHR9XG5cblx0XHRpZiAoQm9vbGVhbih0aGlzLnNldHRpbmdzLlJlcXVpcmVQcm9qZWN0VGFnKSkge1xuXHRcdFx0cmV0dXJuIGZpbGVuYW1lLnN0YXJ0c1dpdGgodGhpcy5zZXR0aW5ncy5wcm9qZWN0c0ZvbGRlclByZWZpeClcblx0XHRcdFx0JiYgZmlsZW5hbWUuZW5kc1dpdGgoJy5tZCcpXG5cdFx0XHRcdCYmICFmaWxlbmFtZS5pbmNsdWRlcygnL18nKVxuXHRcdFx0XHQmJiBoYXNQcm9qZWN0VGFnO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zb2xlLmxvZyhcIm5vXCIpXG5cdFx0XHRyZXR1cm4gZmlsZW5hbWUuc3RhcnRzV2l0aCh0aGlzLnNldHRpbmdzLnByb2plY3RzRm9sZGVyUHJlZml4KVxuXHRcdFx0XHQmJiBmaWxlbmFtZS5lbmRzV2l0aCgnLm1kJylcblx0XHRcdFx0JiYgIWZpbGVuYW1lLmluY2x1ZGVzKCcvXycpO1xuXHRcdH1cblx0fVxuXG5cdHNjaGVkdWxlUmVwYWludEJhZGdlID0gKHBhdGg6IHN0cmluZywgY2xlYXJBbGw6IGJvb2xlYW4pID0+IHtcblx0XHR3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRjb25zdCBsZWF2ZXMgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKCdmaWxlLWV4cGxvcmVyJyk7XG5cdFx0XHRpZiAobGVhdmVzPy5bMF0/LnZpZXc/LmZpbGVJdGVtcz8uW3BhdGhdKSB7XG5cdFx0XHRcdGlmIChjbGVhckFsbCkgY2xlYXJBbGxCYWRnZXMobGVhdmVzWzBdLnZpZXcuZmlsZUl0ZW1zW3BhdGhdKTtcblx0XHRcdFx0ZWxzZSBwYWludEZpbGVCYWRnZS5jYWxsKHRoaXMsIHRoaXMuc2V0dGluZ3MucHJvamVjdEZpbGVDYWNoZVtwYXRoXSwgbGVhdmVzWzBdLnZpZXcuZmlsZUl0ZW1zW3BhdGhdKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdHVwZGF0ZUZpbGVDYWNoZUFuZE1heWJlUmVwYWludEJhZGdlID0gYXN5bmMgKHsgcGF0aCwgc3RhdCwgZGVsZXRlZCB9OiBhbnksIG9yaWdpbmFsRmlsZW5hbWU6IHN0cmluZykgPT4ge1xuXHRcdFxuXHRcdGlmIChkZWxldGVkIHx8ICF0aGlzLmlzUHJvamVjdEZpbGUocGF0aCkpIHtcblx0XHRcdGRlbGV0ZSB0aGlzLnNldHRpbmdzLnByb2plY3RGaWxlQ2FjaGVbcGF0aF07XG5cdFx0XHRkZWxldGUgdGhpcy5zZXR0aW5ncy5wcm9qZWN0RmlsZUNhY2hlW29yaWdpbmFsRmlsZW5hbWVdO1xuXHRcdFx0YXdhaXQgdGhpcy5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdHJldHVybiB0aGlzLnNjaGVkdWxlUmVwYWludEJhZGdlKHBhdGgsIHRydWUpO1xuXHRcdH1cblx0XHRpZiAoIWRlbGV0ZWQpIHtcblx0XHRcdGNvbnN0IHN0cmluZyA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNhY2hlZFJlYWQodGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHBhdGgpKTtcblxuXHRcdFx0Y29uc3QgeyBUb2RvaXN0TGluayB9ID0gdGhpcy5zZXR0aW5ncy5wcm9qZWN0RmlsZUNhY2hlW3BhdGhdIHx8IHt9O1xuXHRcdFx0dGhpcy5zZXR0aW5ncy5wcm9qZWN0RmlsZUNhY2hlW3BhdGhdID0gdGhpcy5zZXR0aW5ncy5wcm9qZWN0RmlsZUNhY2hlW3BhdGhdIHx8IHt9O1xuXHRcdFx0dGhpcy5zZXR0aW5ncy5wcm9qZWN0RmlsZUNhY2hlW3BhdGhdLm10aW1lID0gc3RhdC5tdGltZTtcblxuXHRcdFx0dGhpcy5zZXR0aW5ncy5wcm9qZWN0RmlsZUNhY2hlW3BhdGhdLlRvZG9pc3RMaW5rID0gZmluZFRvZG9pc3RQcm9wZXJ0eShzdHJpbmcsIHRoaXMudG9kb2lzdFByb3BlcnR5KTtcblxuXHRcdFx0YXdhaXQgdGhpcy5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdGlmICh0aGlzLnNldHRpbmdzLnByb2plY3RGaWxlQ2FjaGVbcGF0aF0uVG9kb2lzdExpbmsgIT09IFRvZG9pc3RMaW5rKSB7XG5cdFx0XHRcdHRoaXMuc2NoZWR1bGVSZXBhaW50QmFkZ2UocGF0aCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0cmVmcmVzaEFsbEZpbGVCYWRnZXMgPSBhc3luYyAoKSA9PiB7XG5cdFx0Y29uc3QgcHJvamVjdEZpbGVzTGlzdCA9IHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKS5maWx0ZXIoZiA9PiB0aGlzLmlzUHJvamVjdEZpbGUoZi5wYXRoKSk7XG5cdFx0Y29uc3QgZmlsZXNNYXA6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcblx0XHRsZXQgbmVlZFRvU2F2ZSA9IGZhbHNlO1xuXG5cdFx0Zm9yIChjb25zdCB0RmlsZSBvZiBwcm9qZWN0RmlsZXNMaXN0KSB7XG5cdFx0XHRmaWxlc01hcFt0RmlsZS5wYXRoXSA9IHRoaXMuc2V0dGluZ3MucHJvamVjdEZpbGVDYWNoZVt0RmlsZS5wYXRoXSB8fCB7XG5cdFx0XHRcdG10aW1lOiB0RmlsZS5zdGF0Lm10aW1lLFxuXHRcdFx0fTtcblx0XHRcdGNvbnN0IGxhc3RDYWNoZSA9IHRoaXMuc2V0dGluZ3MucHJvamVjdEZpbGVDYWNoZVt0RmlsZS5wYXRoXTtcblx0XHRcdGlmICh0RmlsZS5zdGF0Lm10aW1lID4gKGxhc3RDYWNoZSA/IGxhc3RDYWNoZS5tdGltZSA6IDApKSB7XG5cdFx0XHRcdG5lZWRUb1NhdmUgPSB0cnVlO1xuXHRcdFx0XHRjb25zdCBzdHJpbmcgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5jYWNoZWRSZWFkKHRGaWxlKTtcblx0XHRcdFx0ZmlsZXNNYXBbdEZpbGUucGF0aF0uVG9kb2lzdExpbmsgPSBmaW5kVG9kb2lzdFByb3BlcnR5KHN0cmluZywgdGhpcy50b2RvaXN0UHJvcGVydHkpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGZvciAoY29uc3QgcGF0aCBpbiB0aGlzLnNldHRpbmdzLnByb2plY3RGaWxlQ2FjaGUpIGlmICghZmlsZXNNYXBbcGF0aF0pIG5lZWRUb1NhdmUgPSB0cnVlO1xuXHRcdGlmIChuZWVkVG9TYXZlKSB7XG5cdFx0XHR0aGlzLnNldHRpbmdzLnByb2plY3RGaWxlQ2FjaGUgPSBmaWxlc01hcDtcblx0XHRcdGF3YWl0IHRoaXMuc2F2ZVNldHRpbmdzKCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnZmlsZS1leHBsb3JlcicpO1xuXG5cdFx0aWYgKGxlYXZlcz8ubGVuZ3RoKSB7XG5cdFx0XHRjb25zdCBmaWxlSXRlbXMgPSBsZWF2ZXNbMF0udmlldz8uZmlsZUl0ZW1zIHx8IHt9O1xuXHRcdFx0Zm9yIChjb25zdCBmIGluIGZpbGVJdGVtcykgaWYgKHRoaXMuaXNQcm9qZWN0RmlsZShmKSkge1xuXHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdHBhaW50RmlsZUJhZGdlLmNhbGwodGhpcywgZmlsZXNNYXBbZl0sIGZpbGVJdGVtc1tmXSk7XG5cdFx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdFx0Y29uc29sZS5lcnJvcihgRXJyb3IgcGFpbnRpbmcgYmFkZ2UgZm9yIGZpbGU6ICR7Zn1gLCBlcnJvcik7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRpbml0aWFsaXplID0gKCkgPT4ge1xuXHRcdHRoaXMucmVmcmVzaEFsbEZpbGVCYWRnZXMoKS5jYXRjaChlcnJvciA9PiB7XG5cdFx0XHRjb25zb2xlLmVycm9yKCdVbmV4cGVjdGVkIGVycm9yIGluIFwidG9kb2lzdC1pbmRpY2F0b3JcIiBwbHVnaW4gaW5pdGlhbGl6YXRpb24uJywgZXJyb3IpO1xuXHRcdH0pO1xuXHR9XG59XG5cbmNsYXNzIFNhbXBsZU1vZGFsIGV4dGVuZHMgTW9kYWwge1xuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCkge1xuXHRcdHN1cGVyKGFwcCk7XG5cdH1cblxuXHRvbk9wZW4oKSB7XG5cdFx0Y29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG5cdFx0Y29udGVudEVsLnNldFRleHQoJ1dvYWghJyk7XG5cdH1cblxuXHRvbkNsb3NlKCkge1xuXHRcdGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuXHRcdGNvbnRlbnRFbC5lbXB0eSgpO1xuXHR9XG59XG5cbmNsYXNzIFNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcblx0cGx1Z2luOiBUb2RvaXN0SW5kaWNhdG9yUGx1Z2luO1xuXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IFRvZG9pc3RJbmRpY2F0b3JQbHVnaW4pIHtcblx0XHRzdXBlcihhcHAsIHBsdWdpbik7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdH1cblxuXHRkaXNwbGF5KCk6IHZvaWQge1xuXHRcdGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cblx0XHRjb250YWluZXJFbC5lbXB0eSgpO1xuXG5cdFx0Y29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnVG9kb2lzdCBJbmRpY2F0b3IgcGx1Z2luIFNldHRpbmdzJyB9KTtcblx0XHRjb250YWluZXJFbC5jcmVhdGVFbCgncCcsIHsgdGV4dDogJ1BsZWFzZSByZWxvYWQgT2JzaWRpYW4gYWZ0ZXIgY2hhbmdpbmcgdGhlc2Ugc2V0dGluZ3MgZm9yIHRoZW0gdG8gdGFrZSBlZmZlY3QuJyB9KTtcblxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuXHRcdFx0LnNldE5hbWUoJ1Byb2plY3RzIGZvbGRlcicpXG5cdFx0XHQuc2V0RGVzYygnVGhlIGZvbGRlciB3aGVyZSBwcm9qZWN0IGZpbGVzIGxpdmUsIGUuZy4gXCJQcm9qZWN0cy9cIi4nKVxuXHRcdFx0LmFkZFRleHQoXG5cdFx0XHRcdHRleHQgPT4gdGV4dFxuXHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcihERUZBVUxUX1NFVFRJTkdTLnByb2plY3RzRm9sZGVyUHJlZml4KVxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9qZWN0c0ZvbGRlclByZWZpeClcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9qZWN0c0ZvbGRlclByZWZpeCA9IHZhbHVlO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0fSlcblx0XHRcdCk7XG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG5cdFx0XHQuc2V0TmFtZSgnVG9kb2lzdCB0YWcnKVxuXHRcdFx0LnNldERlc2MoJ1RoZSB0YWcgdGhhdCBpbmRpY2F0ZXMgVG9kb2lzdCBsaW5rLicpXG5cdFx0XHQuYWRkVGV4dChcblx0XHRcdFx0dGV4dCA9PiB0ZXh0XG5cdFx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKERFRkFVTFRfU0VUVElOR1MudG9kb2lzdFByb3BlcnR5KVxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy50b2RvaXN0UHJvcGVydHkpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MudG9kb2lzdFByb3BlcnR5ID0gdmFsdWU7XG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHR9KVxuXHRcdFx0KTtcblx0XHRcblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKCdSZXF1aXJlIFByb2plY3QgVGFnPycpXG5cdFx0XHQuc2V0RGVzYygnV2l0aCB0aGlzIHNldHRpbmcgZW5hYmxlZCwgYmFkZ2VzIHdpbGwgb25seSBhcHBlYXIgb24gZmlsZXMgKGFuZCB0aGVpciBjb250YWluaW5nIGZvbGRlcikgd2l0aCB0aGUgcHJvamVjdCB0YWcuJylcblx0XHRcdC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuUmVxdWlyZVByb2plY3RUYWcpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5SZXF1aXJlUHJvamVjdFRhZyA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KVxuXHRcdFx0KTtcblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKCdQcm9qZWN0IHRhZycpXG5cdFx0XHQuc2V0RGVzYygnVGhlIHRhZyB0aGF0IGluZGljYXRlcyBhIGZpbGUgaXMgYSBwcm9qZWN0IGZpbGUgKGhhbmR5IGluIGNhc2UgeW91IHN0b3JlIHByb2plY3QgcmVsYXRlZCBmaWxlcyBpbiBhIHByb2plY3QgZm9sZGVyKS4nKVxuXHRcdFx0LmFkZFRleHQoXG5cdFx0XHRcdHRleHQgPT4gdGV4dFxuXHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcihERUZBVUxUX1NFVFRJTkdTLnByb2plY3RUYWcpXG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnByb2plY3RUYWcpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvamVjdFRhZyA9IHZhbHVlO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0fSlcblx0XHRcdCk7XG5cdH1cbn1cbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxzQkFBNEY7QUFXNUYsSUFBTSxtQkFBc0Q7QUFBQSxFQUMzRCxpQkFBaUI7QUFBQSxFQUNqQixzQkFBc0I7QUFBQSxFQUN0QixZQUFZO0FBQUEsRUFDWixtQkFBbUI7QUFBQSxFQUNuQixZQUFZO0FBQUEsRUFDWixrQkFBa0IsQ0FBQztBQUNwQjtBQUVBLFNBQVMsZUFBZSxnQkFBd0I7QUFDL0MsUUFBTSxtQkFBbUIsZUFBZSxNQUFNLHVCQUF1QjtBQUNyRSxNQUFJLGtCQUFrQjtBQUNyQixVQUFNLGNBQWMsaUJBQWlCLENBQUM7QUFDdEMsV0FBTyxVQUFVLFdBQVc7QUFBQSxFQUM3QjtBQUNBLFNBQU87QUFDUjtBQUVBLFNBQVMsVUFBVSxhQUFxQjtBQUN2QyxRQUFNLFFBQVEsWUFBWSxNQUFNLElBQUk7QUFDcEMsUUFBTSxTQUFTLENBQUM7QUFDaEIsTUFBSSxhQUFhO0FBRWpCLFFBQU0sUUFBUSxVQUFRO0FBQ3JCLFFBQUksS0FBSyxLQUFLLE1BQU07QUFBSTtBQUV4QixVQUFNLGdCQUFnQixLQUFLLE1BQU0sd0JBQXdCO0FBQ3pELFFBQUksZUFBZTtBQUNsQixZQUFNLFNBQVMsY0FBYyxDQUFDLEVBQUU7QUFDaEMsWUFBTSxNQUFNLGNBQWMsQ0FBQyxFQUFFLEtBQUs7QUFDbEMsWUFBTSxRQUFRLGNBQWMsQ0FBQyxFQUFFLEtBQUs7QUFFcEMsVUFBSSxXQUFXLEdBQUc7QUFDakIsZUFB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
